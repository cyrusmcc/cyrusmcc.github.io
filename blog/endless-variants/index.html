<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon-dark.svg" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/svg+xml" href="/favicon-light.svg" media="(prefers-color-scheme: light)"><link rel="icon" type="image/x-icon" href="/favicon-light.svg"><meta name="generator" content="Astro v4.16.10"><!-- Font preloads --><link rel="preload" href="/_astro/inter-latin-400-normal.BOOGhInR.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/_astro/inter-latin-600-normal.D273HNI0.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/_astro/lora-latin-400-normal.CvHVDnm4.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/_astro/lora-latin-600-normal.DUWh3m6k.woff2" as="font" type="font/woff2" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://cyrusmcc.com/blog/endless-variants/"><!-- Primary Meta Tags --><title>Generating a Million Model Variations with Three.js | Cyrus McCormick</title><meta name="title" content="Generating a Million Model Variations with Three.js | Cyrus McCormick"><meta name="description" content=""><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://cyrusmcc.com/blog/endless-variants/"><meta property="og:title" content="Generating a Million Model Variations with Three.js | Cyrus McCormick"><meta property="og:description" content=""><meta property="og:image" content="https://cyrusmcc.com/nano.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://cyrusmcc.com/blog/endless-variants/"><meta property="twitter:title" content="Generating a Million Model Variations with Three.js | Cyrus McCormick"><meta property="twitter:description" content=""><meta property="twitter:image" content="https://cyrusmcc.com/nano.png"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script>
  function init() {
    preloadTheme();
    onScroll();
    animate();

    const backToTop = document.getElementById("back-to-top");
    backToTop?.addEventListener("click", (event) => scrollToTop(event));

    const backToPrev = document.getElementById("back-to-prev");
    backToPrev?.addEventListener("click", () => window.history.back());

    const lightThemeButton = document.getElementById("light-theme-button");
    lightThemeButton?.addEventListener("click", () => {
      localStorage.setItem("theme", "light");
      toggleTheme(false);
    });

    const darkThemeButton = document.getElementById("dark-theme-button");
    darkThemeButton?.addEventListener("click", () => {
      localStorage.setItem("theme", "dark");
      toggleTheme(true);
    });

    const systemThemeButton = document.getElementById("system-theme-button");
    systemThemeButton?.addEventListener("click", () => {
      localStorage.setItem("theme", "system");
      toggleTheme(window.matchMedia("(prefers-color-scheme: dark)").matches);
    });

    window.matchMedia("(prefers-color-scheme: dark)")
      .addEventListener("change", event => {
        if (localStorage.theme === "system") {
          toggleTheme(event.matches);
        }
      }
    );

    document.addEventListener("scroll", onScroll);
  }

  function animate() {
    const animateElements = document.querySelectorAll(".animate");

    animateElements.forEach((element, index) => {
      setTimeout(() => {
        element.classList.add("show");
      }, index * 150);
    });
  }

  function onScroll() {
    if (window.scrollY > 0) {
      document.documentElement.classList.add("scrolled");
    } else {
      document.documentElement.classList.remove("scrolled");
    }
  }

  function scrollToTop(event) {
    event.preventDefault();
    window.scrollTo({
      top: 0,
      behavior: "smooth"
    });
  }

function toggleTheme(dark) {
    const css = document.createElement("style");

    css.appendChild(
      document.createTextNode(
        `* {
             -webkit-transition: none !important;
             -moz-transition: none !important;
             -o-transition: none !important;
             -ms-transition: none !important;
             transition: none !important;
          }
        `,
      )
    );

    document.head.appendChild(css);

    if (dark) {
      document.documentElement.classList.add("dark");
    } else {
      document.documentElement.classList.remove("dark");
    }

  window.getComputedStyle(css).opacity;
    document.head.removeChild(css);
  }

  function preloadTheme() {
    const userTheme = localStorage.theme;

    if (userTheme === "light" || userTheme === "dark") {
      toggleTheme(userTheme === "dark");
    } else {
      toggleTheme(window.matchMedia("(prefers-color-scheme: dark)").matches);
    }
  }

  document.addEventListener("DOMContentLoaded", () => init());
  document.addEventListener("astro:after-swap", () => init());
  preloadTheme();
</script><link rel="stylesheet" href="/_astro/_slug_.BkUOqyx8.css"><script type="module" src="/_astro/hoisted.BR8vG9kO.js"></script></head> <body> <header> <div class="mx-auto max-w-screen-sm px-5">  <div class="flex flex-wrap gap-y-2 justify-between"> <a href="/" target="_self" class="inline-block decoration-black/15 dark:decoration-white/30 hover:decoration-black/25 hover:dark:decoration-white/50 text-current hover:text-black hover:dark:text-white transition-colors duration-300 ease-in-out">  <div class="font-semibold"> Cyrus McCormick </div>  </a> <nav class="flex gap-1"> <a href="/blog" target="_self" class="inline-block decoration-black/15 dark:decoration-white/30 hover:decoration-black/25 hover:dark:decoration-white/50 text-current hover:text-black hover:dark:text-white transition-colors duration-300 ease-in-out underline underline-offset-2"> 
blog
 </a> <span> / </span> <a href="/work" target="_self" class="inline-block decoration-black/15 dark:decoration-white/30 hover:decoration-black/25 hover:dark:decoration-white/50 text-current hover:text-black hover:dark:text-white transition-colors duration-300 ease-in-out underline underline-offset-2"> 
work
 </a> <span> / </span> <a href="/projects" target="_self" class="inline-block decoration-black/15 dark:decoration-white/30 hover:decoration-black/25 hover:dark:decoration-white/50 text-current hover:text-black hover:dark:text-white transition-colors duration-300 ease-in-out underline underline-offset-2"> 
projects
 </a> </nav> </div>  </div> </header> <main>  <div class="mx-auto max-w-screen-sm px-5">  <div class="animate"> <a href="/blog" class="relative group w-fit flex pl-7 pr-3 py-1.5 flex-nowrap rounded border border-black/15 dark:border-white/20 hover:bg-black/5 dark:hover:bg-white/5 hover:text-black dark:hover:text-white transition-colors duration-300 ease-in-out"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="absolute top-1/2 left-2 -translate-y-1/2 size-4 stroke-2 fill-none stroke-current"> <line x1="5" y1="12" x2="19" y2="12" class="translate-x-2 group-hover:translate-x-0 scale-x-0 group-hover:scale-x-100 transition-transform duration-300 ease-in-out"></line> <polyline points="12 5 5 12 12 19" class="translate-x-1 group-hover:translate-x-0 transition-transform duration-300 ease-in-out"></polyline> </svg> <div class="text-sm"> 
Back to blog
 </div> </a> </div> <div class="space-y-1 my-10"> <div class="animate flex items-center gap-1.5"> <div class="font-base text-sm"> <time datetime="2025-08-28T06:00:00.000Z"> Aug 28, 2025 </time> </div>
&bull;
<div class="font-base text-sm"> 4 min read </div> </div> <div class="animate text-2xl font-semibold text-black dark:text-white"> Generating a Million Model Variations with Three.js </div> </div> <article class="animate"> <iframe src="https://webfinz.icdtea.com/embed/fish-showcase" width="100%" height="400px" frameborder="0" border-radius="12px" title="Fish Game Showcase" allowtransparency="true"></iframe>
<h2 id="working-with-the-model">Working with the Model</h2>
<p>To get started, youâ€™ll need a 3D model in GLB/GLTF format. I recommend using a base white model, as this provides the most flexibility for applying colors and textures dynamically.</p>
  <!-- <iframe 
      src="http://localhost:5173/embed/
  fish-showcase?mode=white" 
      width="100%" 
      height="400px" 
      frameborder="0"
      title="Fish Game Showcase - 
  White"
      allowtransparency="true"
  ></iframe> -->
<p>If you want to apply separate colors or textures to specific parts of your model, you can select those model faces and assign them different materials. For example, my fish model has separate materials for:</p>
<ul>
<li>Eyes</li>
<li>Fins</li>
<li>Upper body</li>
<li>Lower body</li>
</ul>
<p>This separation allows me to control the color and texture of each piece independently.</p>
<h3 id="loading-a-model-with-threejs">Loading a Model with Three.js</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="typescript"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">scene</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">nodes</span><span style="color:#E1E4E8"> } </span><span style="color:#F97583">=</span><span style="color:#B392F0"> useGLTF</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">`/models/fish/${</span><span style="color:#E1E4E8">fish</span><span style="color:#9ECBFF">.</span><span style="color:#E1E4E8">physicalAttributes</span><span style="color:#9ECBFF">.</span><span style="color:#E1E4E8">model</span><span style="color:#9ECBFF">}.glb`</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span></code></pre>
<h2 id="texture-mapping">Texture Mapping</h2>
  <!-- <iframe 
      src="http://localhost:5173/embed/
  fish-showcase?mode=pattern-mask" 
      width="100%" 
      height="400px" 
      frameborder="0"
      title="Fish Game Showcase - 
  Pattern Mask"
      allowtransparency="true"
  ></iframe> -->
<p>Texture mapping is the technique we use to apply patterns or details to our model. Hereâ€™s how it works:</p>
<ul>
<li>The texture map overlays or wraps around your model with the pattern you want to use</li>
<li>We apply a shader to the model that allows us to apply color to the white areas of our texture map while hiding or applying a separate color to the black areas</li>
</ul>
<img src="https://github.com/cyrusmcc/icdtea-imgs/blob/main/cyrusmcc/blogs/texturemap.png?raw=true">
<p><em>Example texture maps: Black and white patterns to wrap our model. White areas will receive your pattern color while black areas will show the base color.</em></p>
<h3 id="creating-the-patterned-material">Creating the Patterned Material</h3>
<p>Hereâ€™s how to create the patterned material for the upper body of my fish example:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="typescript"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> fishUpperBodyMaterial</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> createTextureMaterial</span><span style="color:#E1E4E8">(fish);</span></span>
<span class="line"></span></code></pre>
<p>Weâ€™ll need to load our texture image files and create a shader material:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="typescript"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> async</span><span style="color:#F97583"> function</span><span style="color:#B392F0"> createBodyMaterial</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#FFAB70">  baseColorHex</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#FFAB70">  patternColorHex</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span></span>
<span class="line"><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> textureImage</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> loadTexture</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">`/textures/patterns/polkadot-pattern.png`</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> material</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#79B8FF"> THREE</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">ShaderMaterial</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">    uniforms: {</span></span>
<span class="line"><span style="color:#E1E4E8">      primaryColor: { value: </span><span style="color:#F97583">new</span><span style="color:#79B8FF"> THREE</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">Color</span><span style="color:#E1E4E8">(baseColorHex) },</span></span>
<span class="line"><span style="color:#E1E4E8">      patternColor: { value: </span><span style="color:#F97583">new</span><span style="color:#79B8FF"> THREE</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">Color</span><span style="color:#E1E4E8">(patternColorHex) }, </span></span>
<span class="line"><span style="color:#E1E4E8">      patternTexture: { value: textureImage },</span></span>
<span class="line"><span style="color:#E1E4E8">    },</span></span>
<span class="line"><span style="color:#E1E4E8">    vertexShader: </span><span style="color:#9ECBFF">`</span></span>
<span class="line"><span style="color:#9ECBFF">      #include &#x3C;common></span></span>
<span class="line"><span style="color:#9ECBFF">      #include &#x3C;skinning_pars_vertex></span></span>
<span class="line"><span style="color:#9ECBFF">      </span></span>
<span class="line"><span style="color:#9ECBFF">      varying vec2 vUv;</span></span>
<span class="line"><span style="color:#9ECBFF">      varying vec3 vPosition;</span></span>
<span class="line"><span style="color:#9ECBFF">      </span></span>
<span class="line"><span style="color:#9ECBFF">      void main() {</span></span>
<span class="line"><span style="color:#9ECBFF">        vUv = uv;</span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        #include &#x3C;skinbase_vertex></span></span>
<span class="line"><span style="color:#9ECBFF">        #include &#x3C;begin_vertex></span></span>
<span class="line"><span style="color:#9ECBFF">        #include &#x3C;skinning_vertex></span></span>
<span class="line"><span style="color:#9ECBFF">        #include &#x3C;project_vertex></span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        vPosition = transformed;</span></span>
<span class="line"><span style="color:#9ECBFF">        gl_Position = projectionMatrix * modelViewMatrix * vec4(transformed, 1.0);</span></span>
<span class="line"><span style="color:#9ECBFF">      }</span></span>
<span class="line"><span style="color:#9ECBFF">    `</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    fragmentShader: </span><span style="color:#9ECBFF">`</span></span>
<span class="line"><span style="color:#9ECBFF">      uniform vec3 primaryColor;</span></span>
<span class="line"><span style="color:#9ECBFF">      uniform vec3 patternColor;</span></span>
<span class="line"><span style="color:#9ECBFF">      uniform sampler2D patternTexture;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">      varying vec2 vUv;</span></span>
<span class="line"><span style="color:#9ECBFF">      varying vec3 vPosition;</span></span>
<span class="line"><span style="color:#9ECBFF">      </span></span>
<span class="line"><span style="color:#9ECBFF">      float random(vec2 st) {</span></span>
<span class="line"><span style="color:#9ECBFF">        return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);</span></span>
<span class="line"><span style="color:#9ECBFF">      }</span></span>
<span class="line"><span style="color:#9ECBFF">      </span></span>
<span class="line"><span style="color:#9ECBFF">      float noise(vec2 st) {</span></span>
<span class="line"><span style="color:#9ECBFF">        vec2 i = floor(st);</span></span>
<span class="line"><span style="color:#9ECBFF">        vec2 f = fract(st);</span></span>
<span class="line"><span style="color:#9ECBFF">        float a = random(i);</span></span>
<span class="line"><span style="color:#9ECBFF">        float b = random(i + vec2(1.0, 0.0));</span></span>
<span class="line"><span style="color:#9ECBFF">        float c = random(i + vec2(0.0, 1.0));</span></span>
<span class="line"><span style="color:#9ECBFF">        float d = random(i + vec2(1.0, 1.0));</span></span>
<span class="line"><span style="color:#9ECBFF">        vec2 u = f * f * (3.0 - 2.0 * f);</span></span>
<span class="line"><span style="color:#9ECBFF">        return mix(a, b, u.x) +</span></span>
<span class="line"><span style="color:#9ECBFF">          (c - a)* u.y * (1.0 - u.x) +</span></span>
<span class="line"><span style="color:#9ECBFF">          (d - b) * u.x * u.y;</span></span>
<span class="line"><span style="color:#9ECBFF">      }</span></span>
<span class="line"><span style="color:#9ECBFF">      </span></span>
<span class="line"><span style="color:#9ECBFF">      // Function to convert RGB to HSL</span></span>
<span class="line"><span style="color:#9ECBFF">      vec3 rgb2hsl(vec3 color) {</span></span>
<span class="line"><span style="color:#9ECBFF">        float maxColor = max(max(color.r, color.g), color.b);</span></span>
<span class="line"><span style="color:#9ECBFF">        float minColor = min(min(color.r, color.g), color.b);</span></span>
<span class="line"><span style="color:#9ECBFF">        float delta = maxColor - minColor;</span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        float h = 0.0;</span></span>
<span class="line"><span style="color:#9ECBFF">        float s = 0.0;</span></span>
<span class="line"><span style="color:#9ECBFF">        float l = (maxColor + minColor) / 2.0;</span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        if (delta > 0.0) {</span></span>
<span class="line"><span style="color:#9ECBFF">          s = l &#x3C; 0.5 ? delta / (maxColor + minColor) : delta / (2.0 - maxColor - minColor);</span></span>
<span class="line"><span style="color:#9ECBFF">          </span></span>
<span class="line"><span style="color:#9ECBFF">          if (color.r == maxColor) {</span></span>
<span class="line"><span style="color:#9ECBFF">            h = (color.g - color.b) / delta + (color.g &#x3C; color.b ? 6.0 : 0.0);</span></span>
<span class="line"><span style="color:#9ECBFF">          } else if (color.g == maxColor) {</span></span>
<span class="line"><span style="color:#9ECBFF">            h = (color.b - color.r) / delta + 2.0;</span></span>
<span class="line"><span style="color:#9ECBFF">          } else {</span></span>
<span class="line"><span style="color:#9ECBFF">            h = (color.r - color.g) / delta + 4.0;</span></span>
<span class="line"><span style="color:#9ECBFF">          }</span></span>
<span class="line"><span style="color:#9ECBFF">          h /= 6.0;</span></span>
<span class="line"><span style="color:#9ECBFF">        }</span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        return vec3(h, s, l);</span></span>
<span class="line"><span style="color:#9ECBFF">      }</span></span>
<span class="line"><span style="color:#9ECBFF">      </span></span>
<span class="line"><span style="color:#9ECBFF">      // Function to convert HSL to RGB</span></span>
<span class="line"><span style="color:#9ECBFF">      float hue2rgb(float p, float q, float t) {</span></span>
<span class="line"><span style="color:#9ECBFF">        if (t &#x3C; 0.0) t += 1.0;</span></span>
<span class="line"><span style="color:#9ECBFF">        if (t > 1.0) t -= 1.0;</span></span>
<span class="line"><span style="color:#9ECBFF">        if (t &#x3C; 1.0/6.0) return p + (q - p) * 6.0 * t;</span></span>
<span class="line"><span style="color:#9ECBFF">        if (t &#x3C; 1.0/2.0) return q;</span></span>
<span class="line"><span style="color:#9ECBFF">        if (t &#x3C; 2.0/3.0) return p + (q - p) * (2.0/3.0 - t) * 6.0;</span></span>
<span class="line"><span style="color:#9ECBFF">        return p;</span></span>
<span class="line"><span style="color:#9ECBFF">      }</span></span>
<span class="line"><span style="color:#9ECBFF">      </span></span>
<span class="line"><span style="color:#9ECBFF">      vec3 hsl2rgb(vec3 hsl) {</span></span>
<span class="line"><span style="color:#9ECBFF">        float h = hsl.x;</span></span>
<span class="line"><span style="color:#9ECBFF">        float s = hsl.y;</span></span>
<span class="line"><span style="color:#9ECBFF">        float l = hsl.z;</span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        if (s == 0.0) {</span></span>
<span class="line"><span style="color:#9ECBFF">          return vec3(l, l, l);</span></span>
<span class="line"><span style="color:#9ECBFF">        }</span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        float q = l &#x3C; 0.5 ? l * (1.0 + s) : l + s - l * s;</span></span>
<span class="line"><span style="color:#9ECBFF">        float p = 2.0 * l - q;</span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        return vec3(</span></span>
<span class="line"><span style="color:#9ECBFF">          hue2rgb(p, q, h + 1.0/3.0),</span></span>
<span class="line"><span style="color:#9ECBFF">          hue2rgb(p, q, h),</span></span>
<span class="line"><span style="color:#9ECBFF">          hue2rgb(p, q, h - 1.0/3.0)</span></span>
<span class="line"><span style="color:#9ECBFF">        );</span></span>
<span class="line"><span style="color:#9ECBFF">      }</span></span>
<span class="line"><span style="color:#9ECBFF">      </span></span>
<span class="line"><span style="color:#9ECBFF">      void main() {</span></span>
<span class="line"><span style="color:#9ECBFF">        // Sample the pattern texture</span></span>
<span class="line"><span style="color:#9ECBFF">        vec4 pattern = texture2D(patternTexture, vUv); // Fixed: was modifiedUV</span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        // Use the pattern's red channel as the blend factor</span></span>
<span class="line"><span style="color:#9ECBFF">        float patternValue = pattern.r; // Fixed: was undefined</span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        // Mix the base color and pattern color based on the pattern value</span></span>
<span class="line"><span style="color:#9ECBFF">        vec3 finalColor = mix(primaryColor, patternColor, patternValue);</span></span>
<span class="line"><span style="color:#9ECBFF">        </span></span>
<span class="line"><span style="color:#9ECBFF">        gl_FragColor = vec4(finalColor, 1.0);</span></span>
<span class="line"><span style="color:#9ECBFF">      }</span></span>
<span class="line"><span style="color:#9ECBFF">    `</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    side: </span><span style="color:#79B8FF">THREE</span><span style="color:#E1E4E8">.DoubleSide,</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> material;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<h2 id="working-with-shaders">Working with Shaders</h2>
<p>We utilize a fragment shader to apply separate colors to the contrasting areas in our texture map. Since our texture map is black and white, we can use a mix function to transform these color values into any other colors we desire.</p>
<p>The process works like this:</p>
<ul>
<li>Apply a base color to the model material itself</li>
<li>Apply another color to the texture that wraps around it</li>
<li>For example, if you want a blue fish with orange polka dots, you would apply blue as the base color and orange to the white areas of your texture map</li>
</ul>
<p>Because we assigned different materials to our model during creation, we can apply shaders to each material belonging to our mesh (model) independently with Three.js.</p>
<p>For the remaining parts of my fish that use solid colors, I use a basic shader material created through a separate function.</p>
<h2 id="applying-the-materials">Applying the Materials</h2>
<p>Once weâ€™ve created all the materials we need, we can traverse through our modelâ€™s scene and replace the base materials with our custom shader materials:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="typescript"><code><span class="line"><span style="color:#E1E4E8">scene.</span><span style="color:#B392F0">traverse</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">child</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (child </span><span style="color:#F97583">instanceof</span><span style="color:#B392F0"> THREE</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">Mesh</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        const</span><span style="color:#79B8FF"> meshName</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> child.name;</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> (blackOut) {</span></span>
<span class="line"><span style="color:#E1E4E8">            child.material </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> eyeMaterial;</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#F97583"> if</span><span style="color:#E1E4E8"> (meshName </span><span style="color:#F97583">===</span><span style="color:#9ECBFF"> 'Fish_Base'</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">            child.material </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> baseMaterial;</span></span>
<span class="line"><span style="color:#E1E4E8">        } </span><span style="color:#F97583">else</span><span style="color:#F97583"> if</span><span style="color:#E1E4E8"> (meshName </span><span style="color:#F97583">===</span><span style="color:#9ECBFF"> 'Fish_Accent'</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">            child.material </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> accentMaterial;</span></span>
<span class="line"><span style="color:#E1E4E8">        } </span><span style="color:#F97583">else</span><span style="color:#F97583"> if</span><span style="color:#E1E4E8"> (meshName </span><span style="color:#F97583">===</span><span style="color:#9ECBFF"> 'Fish_Black'</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">            child.material </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> eyeMaterial;</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#F97583"> if</span><span style="color:#E1E4E8"> (meshName </span><span style="color:#F97583">===</span><span style="color:#9ECBFF"> 'Fish_Upper'</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">            child.material </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> bodyMaterial;</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">});  </span></span>
<span class="line"></span></code></pre>
<p>This approach allows us to generate countless variations of our model by simply changing the color values and texture patterns, creating a virtually infinite number of unique appearances from a single base model.</p> </article>  </div>  </main> <footer class="animate"> <div class="mx-auto max-w-screen-sm px-5">  <div class="relative"> <div class="absolute right-0 -top-20"> <button id="back-to-top" class="relative group w-fit flex pl-8 pr-3 py-1.5 flex-nowrap rounded border border-black/15 dark:border-white/20 hover:bg-black/5 dark:hover:bg-white/5 hover:text-black dark:hover:text-white transition-colors duration-300 ease-in-out"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="absolute top-1/2 left-2 -translate-y-1/2 size-4 stroke-2 fill-none stroke-current rotate-90"> <line x1="5" y1="12" x2="19" y2="12" class="translate-x-2 group-hover:translate-x-0 scale-x-0 group-hover:scale-x-100 transition-transform duration-300 ease-in-out"></line> <polyline points="12 5 5 12 12 19" class="translate-x-1 group-hover:translate-x-0 transition-transform duration-300 ease-in-out"></polyline> </svg> <div class="text-sm">
Back to top
</div> </button> </div> </div> <div class="flex justify-between items-center"> <div>
&copy; 2025 | Cyrus McCormick </div> <div class="flex flex-wrap gap-1 items-center"> <button id="light-theme-button" aria-label="Light theme" class="group size-8 flex items-center justify-center rounded-full"> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="group-hover:stroke-black group-hover:dark:stroke-white transition-colors duration-300 ease-in-out"> <circle cx="12" cy="12" r="5"></circle> <line x1="12" y1="1" x2="12" y2="3"></line> <line x1="12" y1="21" x2="12" y2="23"></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line> <line x1="1" y1="12" x2="3" y2="12"></line> <line x1="21" y1="12" x2="23" y2="12"></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line> </svg> </button> <button id="dark-theme-button" aria-label="Dark theme" class="group size-8 flex items-center justify-center rounded-full"> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="group-hover:stroke-black group-hover:dark:stroke-white transition-colors duration-300 ease-in-out"> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path> </svg> </button> <button id="system-theme-button" aria-label="System theme" class="group size-8 flex items-center justify-center rounded-full"> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="group-hover:stroke-black group-hover:dark:stroke-white transition-colors duration-300 ease-in-out"> <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect> <line x1="8" y1="21" x2="16" y2="21"></line> <line x1="12" y1="17" x2="12" y2="21"></line> </svg> </button> </div> </div>  </div> </footer> </body></html>